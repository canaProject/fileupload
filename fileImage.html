<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Selection Demo</title>
    <style>
        #imageResult {
            display: none;
            width: 100%;
            max-width: 300px;
            margin-top: 20px;
        }
    </style>
</head>
<body>

    <br>

    <button onclick="captureImage()">Capture Image from Camera</button>
    <br>

    <input type="file" id="fileInput" accept="image/*" style="display: none;" onchange="handleFileSelect(event)">

    <img id="imageResult" alt="Selected Image">
    <P></P>

    <script>

        function captureImage() {
            window.flutter_inappwebview.callHandler('captureImageFromCamera');
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (!file) {
                console.error('No file selected');
                return;
            }

            const reader = new FileReader();

            reader.onload = function(e) {
                const dataURL = e.target.result;
                const output = document.getElementById('imageResult');
                if (!output) {
                    console.error('Image result element not found');
                    return;
                }
                output.src = dataURL;
                output.style.display = 'block';
            };

            reader.onerror = function(e) {
                console.error('FileReader error:', e.target.error);
            };

            reader.readAsDataURL(file);
        }

        function handleImage(base64Image) {
            const output = document.getElementById('imageResult');
            if (!output) {
                console.error('Image result element not found');
                return;
            }
            console.log(base64Image)
            output.src = 'data:image/png;base64,' + base64Image; // Adjust MIME type as needed
            output.style.display = 'block';
        }
    </script>
</body>
</html>
 -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Selection Demo</title>
    <style>
        #imageResult {
            display: none;
            width: 100%;
            max-width: 300px;
            margin-top: 20px;
        }

        #base64ImageDisplay {
            margin-top: 20px;
            white-space: pre-wrap; /* Ensure base64 string wraps */
            word-wrap: break-word;
            max-width: 100%;
            font-family: monospace; /* Optional: makes base64 easier to read */
            font-size: 12px;
        }
    </style>
</head>
<body>

    <br>

    <button onclick="captureImage()">Capture Image from Camera</button>
    <br>

    <input type="file" id="fileInput" accept="image/*" style="display: none;" onchange="handleFileSelect(event)">
    <br>

    <img id="imageResult" alt="Selected Image">
    <p id="base64ImageDisplay"></p> <!-- Added id for displaying base64 -->

    <script>
        // Function to invoke Flutter to capture image from camera
        function captureImage() {
            window.flutter_inappwebview.callHandler('captureImageFromCamera');
        }

        // Function to handle the image file selection from the file input
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (!file) {
                console.error('No file selected');
                return;
            }

            const reader = new FileReader();

            reader.onload = function(e) {
                const dataURL = e.target.result;
                const output = document.getElementById('imageResult');
                if (!output) {
                    console.error('Image result element not found');
                    return;
                }
                output.src = dataURL;
                output.style.display = 'block';

                // Display base64 string in <p> tag
                const base64Image = dataURL.split(',')[1]; // Extract base64 part of the data URL
                displayBase64(base64Image);
            };

            reader.onerror = function(e) {
                console.error('FileReader error:', e.target.error);
            };

            reader.readAsDataURL(file);
        }

        // Function to handle the base64 string from Flutter and display it
        function handleImage(base64Image) {
            const output = document.getElementById('imageResult');
            const base64Display = document.getElementById('base64ImageDisplay');
            
            if (!output || !base64Display) {
                console.error('Required elements not found');
                return;
            }

            // Display the base64 string in the <p> tag
            base64Display.textContent = base64Image;

            // Display the image in the <img> tag using the base64 string
            output.src = `data:image/png;base64,${base64Image}`;
            output.style.display = 'block';
        }

        // Function to display base64 string in <p> tag
        function displayBase64(base64) {
            const base64Display = document.getElementById('base64ImageDisplay');
            if (base64Display) {
                base64Display.textContent = base64; // Display base64 string in <p> tag
            }
        }
    </script>

</body>
</html>
